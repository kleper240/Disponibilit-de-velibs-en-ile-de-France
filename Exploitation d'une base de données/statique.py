import mysql.connector
import json

connection = mysql.connector.connect(host="localhost", user="root", password="root", database="velibs")
basedb = connection.cursor()

def crea():
    basedb.execute("CREATE TABLE IF NOT EXISTS station_information_static (stationcode TEXT, name TEXT, capacity INT, longitude DOUBLE, latitude DOUBLE)")

    sql = "INSERT INTO station_information_static (stationcode, name, capacity, longitude, latitude) VALUES (%s, %s, %s, %s, %s)"

    with open('velib-disponibilite-en-temps-reel.json', 'r') as f:
        data = json.load(f)
        for i in range(len(data)):
            value = (data[i]['stationcode'], data[i]['name'], data[i]['capacity'], data[i]['coordonnees_geo']["lon"], data[i]['coordonnees_geo']["lat"])
            basedb.execute(sql, value)
        print("La mise à jour a été effectuée")
crea()
def supp():
    basedb.execute("drop table station_information_static ")
    print("la table a ete supprimé")





connection.commit()
basedb.close()
